<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Kosmo 154 Mall :: register</title>
    <link rel="stylesheet" href="/css/register.css">
    <style>
        .error-message {
            color: red;
            margin-top: 10px;
            display: block;
        }
    </style>
</head>
<body>
<form action="/register/newUser" method="POST" onsubmit="return validateForm()">
<!--    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">-->
    <div>
        <label for="email">이메일:</label>
        <input type="email" id="email" name="email"
               placeholder="이메일 주소" required
               onkeyup="validateEmail()" onblur="validateEmail()">
        <span id="emailError" class="error-message"></span>
    </div>
    <div>
        <label for="password">비밀번호:</label>
        <input type="password" id="password" name="password"
               placeholder="비밀번호" required minlength="8" maxlength="20"
               pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$"
               onkeyup="validatePassword(); checkPasswordMatch()" onblur="validatePassword()">
        <!-- 최소 8자, 최대 20자.
        적어도 하나의 소문자 (?=.*[a-z]) 적어도 하나의 대문자 (?=.*[A-Z]) 적어도 하나의 숫자 (?=.*\d)
        적어도 하나의 특수문자 (@$!%*?&) (?=.*[@$!%*?&])를 포함해야 합니다. -->
        <span id="passwordError" class="error-message"></span>
    </div>
    <div>
        <label for="passwordConfirm">비밀번호 확인:</label>
        <input type="password" id="passwordConfirm" name="passwordConfirm"
               placeholder="비밀번호 재입력" required
               onkeyup="checkPasswordMatch()">
        <span id="passwordConfirmError" class="error-message"></span>
    </div>
    <div>
        <label for="name">이름:</label>
        <input name="name" placeholder="이름" id="name" required>
        <!--               onkeyup="validateName()" onblur="validateName()"-->
        <span id="nameError" class="error-message"></span>
    </div>
    <div>

        <label for="phone">핸드폰 번호:</label>
        <input name="phone" placeholder="핸드폰 번호(010-1234-5678)" id="phone" required>
        <!--               onkeyup="validateName()" onblur="validateName()"-->
        <span id="phoneError" class="error-message"></span>
    </div>


    <div>
        <label for="nickname">닉네임:</label>
        <input type="text" id="nickname" name="nickname"
               placeholder="닉네임" required minlength="2" maxlength="15"
               onkeyup="validateNickname()" onblur="validateNickname()">
        <span id="nicknameError" class="error-message"></span>
    </div>
    <div>
        <label for="profileImage">프로필 이미지 URL (선택 사항):</label>
        <input type="url" id="profileImage" name="profileImage" placeholder="프로필 이미지 URL (선택)">
        <span id="profileImageError" class="error-message"></span>
    </div>

    <button type="submit">전송</button>
</form>
<div th:if="${#lists.size(errors ?: {}) > 0}" id="errorModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>오류 발생</h2>
        <ul id="errorList">
            <!-- 오류 메시지는 JavaScript로 동적으로 추가 -->
        </ul>
    </div>
</div>

<div id="emailErrorModal" class="modal">
    <div class="modal-body">
        <p id="errorMessage"></p>
    </div>
    <button onclick="closeErrorModal()"
            id="closeBtn">닫기</button>
</div>
<script th:inline="javascript">
  const serverErrorMessages = /*[[${errors}]]*/ [];

    window.onload = function() {
      /* [[${emailError}]] : Thymeleaf 변수 */
      var errorMessage = [[${emailError}]];
      if (errorMessage) {
          showErrorModal(errorMessage);
      }
  };


  function showErrorModal(message) {
  document.getElementById('errorMessage').textContent = message;
  document.getElementById('emailErrorModal').style.display = 'block';
}

function closeErrorModal() {
  document.getElementById('emailErrorModal').style.display = 'none';
<!--  document.getElementById('modalOverlay').style.display = 'none';-->
}
</script>
<script src="/js/registerValidation.js" defer></script>
</body>
</html>