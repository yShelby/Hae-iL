<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Kosmo 154 Mall :: register</title>
    <link rel="stylesheet" href="/css/register.css">
</head>
<body>
<form action="/register/newUser" method="POST" onsubmit="return validateForm()">
<!--    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">-->
    <div>
        <label for="email">이메일:</label>
        <input type="email" id="email" name="email"
               placeholder="이메일 주소" required
               pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
               onkeyup="validateEmail()" onblur="validateEmail()">
        <span id="emailError" class="error-message"></span>
    </div>

    <div>
        <label for="nickname">닉네임:</label>
        <input type="text" id="nickname" name="nickname"
               placeholder="닉네임" required minlength="2" maxlength="15"
               onkeyup="validateNickname()" onblur="validateNickname()">
        <span id="nicknameError" class="error-message"></span>
    </div>

    <div>
        <label for="password">비밀번호:</label>
        <input type="password" id="password" name="password"
               placeholder="비밀번호" required minlength="8" maxlength="20"
               pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$"
               onkeyup="validatePassword(); checkPasswordMatch()" onblur="validatePassword()">
        <!-- 최소 8자, 최대 20자.
        적어도 하나의 소문자 (?=.*[a-z]) 적어도 하나의 대문자 (?=.*[A-Z]) 적어도 하나의 숫자 (?=.*\d)
        적어도 하나의 특수문자 (@$!%*?&) (?=.*[@$!%*?&])를 포함해야 합니다. -->
        <span id="passwordError" class="error-message"></span>
    </div>

    <div>
        <label for="passwordConfirm">비밀번호 확인:</label>
        <input type="password" id="passwordConfirm" name="passwordConfirm"
               placeholder="비밀번호 재입력" required
               onkeyup="checkPasswordMatch()">
        <span id="passwordConfirmError" class="error-message"></span>
    </div>

    <div>
        <label for="profileImage">프로필 이미지 URL (선택 사항):</label>
        <input type="url" id="profileImage" name="profileImage" placeholder="프로필 이미지 URL (선택)">
        <span id="profileImageError" class="error-message"></span>
    </div>

    <button type="submit">전송</button>
</form>
<div th:if="${#lists.size(errors ?: {}) > 0}" id="errorModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>오류 발생</h2>
        <ul id="errorList">
            <!-- 오류 메시지는 JavaScript로 동적으로 추가 -->
        </ul>
    </div>
</div>
<script th:inline="javascript">
    const serverErrorMessages = /*[[${errors}]]*/ [];
</script>
<script src="/js/registerValidation.js" defer></script>
</body>
</html>